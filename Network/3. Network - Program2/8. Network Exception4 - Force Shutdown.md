-----
### ë„¤íŠ¸ì›Œí¬ ì˜ˆì™¸4 - ê°•ì œ ì¢…ë£Œ
-----
1. TCP ì—°ê²° ì¤‘ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ RSTë¼ëŠ” íŒ¨í‚· ë°œìƒí•˜ëŠ”ë°, ì´ ê²½ìš° ì—°ê²°ì„ ì¦‰ì‹œ ì¢…ë£Œí•´ì•¼ í•¨
2. ResetCloseServer(/network/close/reset)
```java
package network.tcp.exception.close.reset;

import util.MyLogger;

import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;

import static util.MyLogger.*;

public class ResetCloseServer {
    public static void main(String[] args) throws IOException {
        ServerSocket serverSocket = new ServerSocket(12345);

        Socket socket = serverSocket.accept();

        log("ì†Œì¼“ ì—°ê²°: " + socket);
        
        socket.close();
        serverSocket.close();
        
        log("ì†Œì¼“ ì¢…ë£Œ");
    }
}
```

3. RestCloseClient
```java
package network.tcp.exception.close.reset;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;
import java.net.SocketException;

import static util.MyLogger.log;

public class ResetCloseClient {
    public static void main(String[] args) throws IOException, InterruptedException {
        Socket socket = new Socket("localhost", 12345);
        InputStream input = socket.getInputStream();
        OutputStream output = socket.getOutputStream();

        log("ì†Œì¼“ ì—°ê²°: " + socket);

        // client <- server: FIN
        Thread.sleep(1000); // ì„œë²„ê°€ close()ë¥¼ í˜¸ì¶œí•  ë•Œ ê¹Œì§€ ëŒ€ê¸°

        // client -> server : PUSH[1] (íŒ¨í‚· ì „ì†¡ : PUSH)
        output.write(1); // ì´ ìƒíƒœì—ì„œ íŒ¨í‚· ì „ì†¡ (FIN ì´í›„ PUSH > TCP ê·œì•½ì—ì„œ ë²—ì–´ë‚¨)

        // client <- server : RST ì‘ë‹µ
        Thread.sleep(1000); // RST ë©”ì„¸ì§€ ì „ì†¡ ëŒ€ê¸°

        try {
            // java.net.SocketException: Connection reset
            int read = input.read(); // RSTë¥¼ ë°›ê²Œ ë˜ë©´,
        } catch (SocketException e) { // SokcetException ë°œìƒ
            e.printStackTrace();
        }

        try {
            // java.net.SocketException: Broken pipe
            output.write(1); // RSTë¥¼ ë°›ê²Œ ëœ í›„, íŒ¨í‚· ì „ì†¡
        } catch (SocketException e) { 
            e.printStackTrace();
        }
    }
}
```

4. ì‹¤í–‰ ê²°ê³¼ - MAC
```
11:10:36.119 [     main] ì†Œìº£ ì—°ê²°: Socket[addr=localhost/ 127.0.0.1,port=12345,localport=54490]
java.net.SocketException: Connection reset
...
java.net.SocketException: Broken pipe
...
```
  - Windows : ìœˆë„ìš°ì˜ ê²½ìš° ê°™ì€ java.net.SocketException ì´ ë°œìƒí•˜ì§€ë§Œ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ë‹¤ë¦„
```
 java.net.SocketException: í˜„ì¬ ì—°ê²°ì€ ì‚¬ìš©ìì˜ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì˜ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì˜í•´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤
	at java.base/sun.nio.ch.SocketDispatcher.read0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:46)
	at java.base/sun.nio.ch.NioSocketImpl.tryRead(NioSocketImpl.java:256)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:307)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:346)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:796)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:1099)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:1093)
	at network.tcp.exception.close.reset.ResetCloseClient.main(ResetCloseClient.java:29)
java.net.SocketException: í˜„ì¬ ì—°ê²°ì€ ì‚¬ìš©ìì˜ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì˜ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì˜í•´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:54)
	at java.base/sun.nio.ch.NioSocketImpl.tryWrite(NioSocketImpl.java:394)
	at java.base/sun.nio.ch.NioSocketImpl.implWrite(NioSocketImpl.java:410)
	at java.base/sun.nio.ch.NioSocketImpl.write(NioSocketImpl.java:440)
	at java.base/sun.nio.ch.NioSocketImpl$2.write(NioSocketImpl.java:819)
	at java.base/java.net.Socket$SocketOutputStream.write(Socket.java:1195)
	at java.base/java.net.Socket$SocketOutputStream.write(Socket.java:1190)
	at network.tcp.exception.close.reset.ResetCloseClient.main(ResetCloseClient.java:35)
```

5. íë¦„
<div align="center">
<img src="https://github.com/user-attachments/assets/15ae1024-0aa5-4c7c-81e5-970bee65b888">
</div>

  - í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°€ ì—°ê²°
  - ì„œë²„ëŠ” ì¢…ë£Œë¥¼ ìœ„í•´ socket.close() í˜¸ì¶œ (ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ FIN íŒ¨í‚· ì „ë‹¬)
  - í´ë¼ì´ì–¸íŠ¸ëŠ” FIN íŒ¨í‚·ì„ ë°›ìŒ (í´ë¼ì´ì–¸íŠ¸ OSì—ì„œ FIN íŒ¨í‚·ì— ëŒ€í•œ ACK íŒ¨í‚· ì „ë‹¬)
  - í´ë¼ì´ì–¸íŠ¸ëŠ” output.write(1)ë¥¼ í†µí•´ ì„œë²„ì— ë©”ì„¸ì§€ë¥¼ ì „ë‹¬ (ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” PUSH íŒ¨í‚·ì„ ì„œë²„ì— ì „ë‹¬)
  - ì„œë²„ëŠ” ì´ë¯¸ FINìœ¼ë¡œ ì¢…ë£Œë¥¼ ìš”ì²­í–ˆëŠ”ë°, PUSH íŒ¨í‚·ìœ¼ë¡œ ë°ì´í„° ì „ì†¡ (ì„œë²„ê°€ ê¸°ëŒ€í•˜ëŠ” ê°’ : FIN)
  - ì„œë²„ëŠ” TCP ì—°ê²°ì— ë¬¸ì œê°€ ìˆë‹¤ê³  íŒë‹¨í•˜ê³ , ì¦‰ê° ì—°ê²°ì„ ì¢…ë£Œí•˜ë¼ëŠ” RST íŒ¨í‚·ì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡

6. RST íŒ¨í‚·ì´ ë„ì°©í–ˆë‹¤ëŠ” ê²ƒì€ í˜„ì¬ TCP ì—°ê²°ì— ì‹¬ê°í•œ ë¬¸ì œê°€ ìˆìœ¼ë¯€ë¡œ, í•´ë‹¹ ì—°ê²°ì„ ë” ì´ìƒ ì‚¬ìš©í•˜ë©´ ì•ˆë˜ëŠ” ì˜ë¯¸
7. RST íŒ¨í‚·ì´ ë„ì°©í•˜ë©´ ìë°”ëŠ” read()ë¡œ ë©”ì„¸ì§€ë¥¼ ì½ì„ ë•Œ ë‹¤ìŒ ì˜ˆì™¸ ë˜ì§
   - MAC : java.net.SocketException: Connection reset
   - ìœˆë„ìš° : java.net.SocketException: í˜„ì¬ ì—°ê²°ì€ ì‚¬ìš©ìì˜ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì˜ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì˜í•´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤

8. RST íŒ¨í‚·ì´ ë„ì°©í•˜ë©´ ìë°”ëŠ” write() ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•  ë•Œ ë‹¤ìŒ ì˜ˆì™¸ë¥¼ ë˜ì§
   - MAC : java.net.SocketException: Broken pipe
   - ìœˆë„ìš° : java.net.SocketException: í˜„ì¬ ì—°ê²°ì€ ì‚¬ìš©ìì˜ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì˜ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì˜í•´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤

9. ì°¸ê³  - RST (Reset)
   - TCPì—ì„œ RST íŒ¨í‚·ì€ ì—°ê²° ìƒíƒœë¥¼ ì´ˆê¸°í™”(Reset)í•´ì„œ ë” ì´ìƒ í˜„ì¬ ì—°ê²°ì„ ìœ ì§€í•˜ì§€ ì•Šê² ë‹¤ëŠ” ì˜ë¯¸ë¥¼ ì „ë‹¬
   - ğŸ’¡ Reset : í˜„ì¬ ì„¸ì…˜ì„ ê°•ì œ ì¢…ë£Œí•˜ê³ , ì—°ê²°ì„ ë¬´íš¨í™”í•˜ë¼ëŠ” ëœ»
   - RST íŒ¨í‚·ì€ TCP ì—°ê²°ì— ë¬¸ì œê°€ ìˆëŠ” ë‹¤ì–‘í•œ ìƒí™©ì— ë°œìƒ
     + TCP ìŠ¤í™ì— ë§ì§€ ì•ŠëŠ” ìˆœì„œë¡œ ë©”ì„¸ì§€ê°€ ì „ë‹¬ë  ë•Œ
     + TCP ë²„í¼ì— ìˆëŠ” ë°ì´í„°ë¥¼ ì•„ì§ ë‹¤ ì½ì§€ ì•Šì•˜ëŠ”ë°, ì—°ê²° ì¢…ë£Œ
     + ë°©í™”ë²½ ê°™ì€ ê³³ì—ì„œ ì—°ê²°ì„ ê°•ì œë¡œ ì¢…ë£Œí•  ë•Œë„ ë°œìƒ

10. ì°¸ê³  - java.net.SocketException: Socket is closed
    - ìê¸° ìì‹ ì˜ ì†Œì¼“ì„ ë‹«ì€ ì´í›„ read(), write()ì„ í˜¸ì¶œí•  ë•Œ ë°œìƒ
    - ResetCloseServer
```java
package network.tcp.exception.close.reset;

import util.MyLogger;

import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;

import static util.MyLogger.*;

public class ResetCloseServer {
    public static void main(String[] args) throws IOException, InterruptedException {
        ServerSocket serverSocket = new ServerSocket(12345);

        Socket socket = serverSocket.accept();

        log("ì†Œì¼“ ì—°ê²°: " + socket);

        Thread.sleep(100000); // ì„œë²„ ë¬´ì‘ë‹µ

        socket.close();
        serverSocket.close();

        log("ì†Œì¼“ ì¢…ë£Œ");
    }
}
```

   - ResetCloseClient
```java
package network.tcp.exception.close.reset;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;
import java.net.SocketException;

import static util.MyLogger.log;

public class ResetCloseClient {
    public static void main(String[] args) throws IOException, InterruptedException {
        Socket socket = new Socket("localhost", 12345);
        InputStream input = socket.getInputStream();
        OutputStream output = socket.getOutputStream();

        log("ì†Œì¼“ ì—°ê²°: " + socket);

        input.close();
        output.close();
        socket.close();

	// java.net.SocketException: Socket is closed

	 try {
            int read = input.read(); // RSTë¥¼ ë°›ê²Œ ë˜ë©´,
        } catch (SocketException e) { // SokcetException ë°œìƒ
            e.printStackTrace();
        }

        try {
            output.write(1); // RSTë¥¼ ë°›ê²Œ ëœ í›„, íŒ¨í‚· ì „ì†¡
        } catch (SocketException e) {
            e.printStackTrace();
        }
    }
}
```

11. ì •ë¦¬
    - ìƒëŒ€ë°©ì´ ì—°ê²°ì„ ì¢…ë£Œí•œ ê²½ìš° ë°ì´í„°ë¥¼ ì½ìœ¼ë©´ EOF ë°œìƒ
      + -1, null, EOFException ë“± ë°œìƒ
      + ì´ ê²½ìš°, ì—°ê²°ì„ ëŠì–´ì•¼ í•¨

    - java.net.SocketException: Connection reset
      + RST íŒ¨í‚·ì„ ë°›ì€ ì´í›„ read() í˜¸ì¶œ
      + ìœˆë„ìš° ì˜¤ë¥˜ ë©”ì„¸ì§€ : í˜„ì¬ ì—°ê²°ì€ ì‚¬ìš©ìì˜ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì˜ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì˜í•´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤
     
    - java.net.SocketException: Broken pipe
      + RST íŒ¨í‚·ì„ ë°›ì€ ì´í›„ write() í˜¸ì¶œ
      + ìœˆë„ìš° ì˜¤ë¥˜ ë©”ì„¸ì§€ : í˜„ì¬ ì—°ê²°ì€ ì‚¬ìš©ìì˜ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œì˜ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì˜í•´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤

    - java.net.SocketException: Socket is closed
      + ìì‹ ì˜ ì†Œì¼“ì„ ë‹«ì€ ì´í›„ read(), write() í˜¸ì¶œ

12. ë„¤íŠ¸ì›Œí¬ ì¢…ë£Œì™€ ì˜ˆì™¸ ì •ë¦¬
    - ê¸°ë³¸ì ìœ¼ë¡œ ì •ìƒ ì¢…ë£Œ, ê°•ì œ ì¢…ë£Œ ëª¨ë‘ ìì›ì„ ì •ë¦¬í•˜ê³  ë‹«ë„ë¡ ì„¤ê³„
    - ì˜ˆë¥¼ ë“¤ì–´, SocketException, EOFException ëª¨ë‘ IOExceptionì˜ ìì‹ì´ë¯€ë¡œ, IOExceptionì´ ë°œìƒí•˜ë©´ ìì›ì„ ì •ë¦¬
    - ë§Œì•½, ë” ìì„¸íˆ ë¶„ë¥˜í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•˜ë©´ ê·¸ ë•ŒëŠ” ì˜ˆì™¸ë¥¼ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬
