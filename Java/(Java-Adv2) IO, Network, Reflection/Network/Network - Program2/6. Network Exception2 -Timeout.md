-----
### ğŸ’¡ ë„¤íŠ¸ì›Œí¬ ì˜ˆì™¸2 - íƒ€ì„ ì•„ì›ƒ
-----
1. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ ì‹œë„í•´ì„œ ì„œë²„ IPì— ì—°ê²° íŒ¨í‚·ì„ ì „ë‹¬í–ˆì§€ë§Œ, ì‘ë‹µì´ ì—†ëŠ” ê²½ìš°
2. TCP ì—°ê²° íƒ€ì„ì•„ì›ƒ - OS ê¸°ë³¸
  - ConnectTimeoutMain1 (/tcp/exception/connect)
```java
package network.tcp.exception.connect;

import java.io.IOException;
import java.net.ConnectException;
import java.net.Socket;

/*
    Windows : ì•½ 21ì´ˆ
    Linux : ì•½ 75ì´ˆì—ì„œ 180ì´ˆ ì‚¬ì´
    MAC : ì•½ 75ì´ˆ
    -> java.net.Connection: Operation timed out
 */
public class ConnectTimeoutMain1 {
    public static void main(String[] args) throws IOException {
        long start = System.currentTimeMillis();

        try {
            Socket socket = new Socket("192.168.1.250", 45678); // 192.168.1.250ì— SYN ì „ë‹¬
        } catch (ConnectException e) {
            // ConnectException: Operation timed out
            e.printStackTrace();
        }

        long end = System.currentTimeMillis();

        System.out.println("time: = " + (end - start));
    }
}
```
  - ì‚¬ì„¤ IP ëŒ€ì—­(ì£¼ë¡œ ê³µìœ ê¸°ì—ì„œ ì‚¬ìš©í•˜ëŠ” IP ëŒ€ì—­)ì˜ ```192.168.1.250```ë¥¼ ì‚¬ìš© (í•´ë‹¹ IPë¡œ ë¬´ì–¸ê°€ ì—°ê²°ë˜ì–´ ìˆë‹¤ë©´, ë‹¤ë¥¸ ê²°ê³¼ ë°œìƒ ê°€ëŠ¥í•˜ë¯€ë¡œ ë§ˆì§€ë§‰ 3ìë¦¬ ë³€ê²½)
  - í•´ë‹¹ IPë¡œ ì—°ê²° íŒ¨í‚·ì„ ë³´ë‚´ì§€ë§Œ IPë¥¼ ì‚¬ìš©í•˜ëŠ” ì„œë²„ê°€ ì—†ìœ¼ë¯€ë¡œ TCP ì‘ë‹µì´ ì˜¤ì§€ ì•ŠìŒ
  - ë˜ëŠ” í•´ë‹¹ IPë¡œ ì—°ê²° íŒ¨í‚·ì„ ë³´ëƒˆì§€ë§Œ, í•´ë‹¹ ì„œë²„ê°€ ë„ˆë¬´ ë°”ì˜ê±°ë‚˜ ë¬¸ì œê°€ ìˆì–´ì„œ ì—°ê²° ì‘ë‹µ íŒ¨í‚·ì„ ë³´ë‚´ì§€ ëª»í•˜ëŠ” ê²½ìš°ë„ ì¡´ì¬

3. OS ê¸°ë³¸ ëŒ€ê¸° ì‹œê°„
   - TCP ì—°ê²°ì„ ì‹œë„í–ˆëŠ”ë°, ì—°ê²° ì‘ë‹µì´ ì—†ë‹¤ë©´ OSì—ëŠ” ì—°ê²° ëŒ€ê¸° íƒ€ì„ ì•„ì›ƒì´ ì„¤ì •
     + Windows : ì•½ 21ì´ˆ
     + Linux : ì•½ 75ì´ˆì—ì„œ 180ì´ˆ ì‚¬ì´
     + MAC Test : ì•½ 75ì´ˆ
   - í•´ë‹¹ ì‹œê°„ì´ ì§€ë‚˜ë©´ ```java.net.ConnectException: Connection timed out``` ë°œìƒ
```
java.net.ConnectException: Operation timed out
  at java.base/sun.nio.ch.Net.connect0(Native Method)
  at java.base/sun.nio.ch.Net.connect(Net.java:589)
  at java.base/sun.nio.ch.Net.connect(Net.java:578)
  at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:583)
  at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
  at java.base/java.net.Socket.connect(Socket.java:752)
  at java.base/java.net.Socket.connect(Socket.java:687)
  at java.base/java.net.Socket.<init>(Socket.java:556)
  at java.base/java.net.Socket.<init>(Socket.java:325)
  at network.exception.connect.ConnectTimeoutMain.connectionWait1(ConnectTimeoutMai n.java:22)
  at network.exception.connect.ConnectTimeoutMain.main(ConnectTimeoutMain.java:12)
end = 75008
```

   - ìœˆë„ìš°ì˜ ê²½ìš° í•´ë‹¹ ì‹œê°„ì´ ì§€ë‚˜ë©´ java.net.ConnectException: Connection timed out: connect ê°€ ë°œìƒ ì˜ˆì™¸ëŠ” ê°™ê³ , ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ë‹¤ë¦„
```
java.net.ConnectException: Connection timed out: connect
	at java.base/sun.nio.ch.Net.connect0(Native Method)
	at java.base/sun.nio.ch.Net.connect(Net.java:589)
	at java.base/sun.nio.ch.Net.connect(Net.java:578)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:583)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:751)
	at java.base/java.net.Socket.connect(Socket.java:686)
	at java.base/java.net.Socket.<init>(Socket.java:555)
	at java.base/java.net.Socket.<init>(Socket.java:324)
	at network.tcp.exception.connect.ConnectTimeoutMain1.main(ConnectTimeoutMain1.java:12)
time: = 21088
```

4. TCP ì—°ê²° íƒ€ì„ì•„ì›ƒ - ì§ì ‘ ì„¤ì •
  - TCP ì—°ê²° íƒ€ì„ ì•„ì›ƒ ì‹œê°„ ì§ì ‘ ì„¤ì •
  - ConnectTimeoutMain2
```java
package network.tcp.exception.connect;

import java.io.IOException;
import java.net.ConnectException;
import java.net.InetSocketAddress;
import java.net.Socket;
import java.net.SocketTimeoutException;

/*
    Windows : ì•½ 21ì´ˆ
    Linux : ì•½ 75ì´ˆì—ì„œ 180ì´ˆ ì‚¬ì´
    MAC : ì•½ 75ì´ˆ
    -> java.net.Connection: Operation timed out
 */
public class ConnectTimeoutMain2 {
    public static void main(String[] args) throws IOException {
        long start = System.currentTimeMillis();

        try {
            Socket socket = new Socket(); // ê°ì²´ë§Œ ìƒì„± ì‹œ, ì•„ì§ ì—°ê²°ë˜ì§€ ì•ŠìŒ
            socket.connect(new InetSocketAddress("192.168.1.250", 45678), 1000); // connect() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ Hostnameê³¼ portë¡œ ì—°ê²°ë˜ë©°, 2ë²ˆì§¸ ì¸ìëŠ” timeout ì„¤ì •
        } catch (SocketTimeoutException e) { // í•´ë‹¹ ì˜ˆì™¸ëŠ” SocketTimeoutException
            // ConnectException: Operation timed out
            e.printStackTrace();
        }

        long end = System.currentTimeMillis();

        System.out.println("time: = " + (end - start));
    }
}
```
  - ì‹¤í–‰ ê²°ê³¼ : ì„¤ì •í•œ ì‹œê°„ì¸ 1ì´ˆê°€ ì§€ë‚œ í›„ íƒ€ì„ ì•„ì›ƒ ì˜ˆì™¸ê°€ ë°œìƒí•˜ëŠ” ê²ƒ í™•ì¸ ê°€ëŠ¥
```
java.net.SocketTimeoutException: Connect timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:546)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:592)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:751)
	at network.tcp.exception.connect.ConnectTimeoutMain2.main(ConnectTimeoutMain2.java:21)
time: = 1035
```
  - new Socket() : Sokcet ê°ì²´ë¥¼ ìƒì„¤í•  ë•Œ ì¸ìë¡œ IP, PORTë¥¼ ëª¨ë‘ ì „ë‹¬í•˜ë©´ ìƒì„±ìì—ì„œ ë°”ë¡œ TCP ì—°ê²° ì‹œë„
    + í•˜ì§€ë§Œ, IPì™€ PORTë¥¼ ëª¨ë‘ ë¹¼ê³  ê°ì²´ë¥¼ ìƒì„±í•˜ë©´, ê°ì²´ë§Œ ìƒì„±ë˜ê³ , ì•„ì§ ì—°ê²°ì€ ì‹œë„í•˜ì§€ ì•ŠìŒ
    + ì¶”ê°€ì ìœ¼ë¡œ í•„ìš”í•œ ì„¤ì •ì„ ë” í•œ ë‹¤ìŒ socket.connect()ë¥¼ í˜¸ì¶œí•˜ë©´,  ê·¸ ë•Œ TCP ì—°ê²° ì‹œë„
    + ì´ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ì¶”ê°€ì ì¸ ì„¤ì •ì„ í•  ìˆ˜ ìˆëŠ”ë°, ëŒ€í‘œì ìœ¼ë¡œ íƒ€ì„ì•„ì›ƒ ì„¤ì • ê°€ëŠ¥

```java
public void connect(SocketAddress endpoint, int timeout) throws IOException { ... }
```
  - InetSocketAddress : SocketAddressì˜ ìì‹ (IP, PORT ê¸°ë°˜ì˜ ì£¼ì†Œë¥¼ ê°ì²´ë¡œ ì œê³µ)
  - timeout : ë°€ë¦¬ì´ˆ ë‹¨ìœ„ë¡œ ì—°ê²° íƒ€ì„ ì•„ì›ƒ ì§€ì • ê°€ëŠ¥
  - íƒ€ì„ì•„ì›ƒ ì‹œê°„ì´ ì§€ë‚˜ë„ ì—°ê²°ì´ ë˜ì§€ ì•Šìœ¼ë©´, ë‹¤ìŒ ì˜ˆì™¸ ë°œìƒ
```
java.net.SocketTimeoutException: Connect timed out
```

5. TCP ì†Œì¼“ íƒ€ì„ì•„ì›ƒ - read íƒ€ì„ ì•„ì›ƒ
   - ì—°ê²°ì´ ëœ ì´í›„ì— í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ì–´ë–¤ ìš”ì²­ì„ í–ˆë‹¤ê³  ê°€ì •
   - ì„œë²„ì— ì‚¬ìš©ìê°€ í­ì£¼í•˜ê±°ë‚˜ ë§¤ìš° ëŠëŸ¬ì ¸ì„œ ì‘ë‹µì„ ì£¼ì§€ ëª»í•˜ëŠ” ìƒí™©ì— ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì†Œì¼“ íƒ€ì„ì•„ì›ƒ (read íƒ€ì„ì•„ì›ƒ)
   - SotTimeoutServer
```java
package network.tcp.exception.connect;

import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;

public class SoTimeoutServer {
    public static void main(String[] args) throws IOException, InterruptedException {
        ServerSocket serverSocket = new ServerSocket(12345);
        Socket socket = serverSocket.accept();

        Thread.sleep(10000000);
    }
}
```
  - ì„œë²„ëŠ” ì†Œì¼“ì„ ì—°ê²°ì€ í•˜ì§€ë§Œ, ì•„ë¬´ëŸ° ì‘ë‹µì„ ì£¼ì§€ ì•ŠìŒ
  - SoTimeoutClient
```java
package network.tcp.exception.connect;

import java.io.IOException;
import java.io.InputStream;
import java.net.Socket;

public class SoTimeoutClient {
    public static void main(String[] args) throws IOException {
        Socket socket = new Socket("localhost", 12345);

        InputStream input = socket.getInputStream();

        try { 
            socket.setSoTimeout(3000); // íƒ€ì„ì•„ì›ƒ ì‹œê°„ ì„¤ì •
            int read = input.read(); // ê¸°ë³¸ì€ ë¬´í•œì •ìœ¼ë¡œ ê¸°ë‹¤ë¦¼
            System.out.println("read = " + read);
        } catch (Exception e) {
            e.printStackTrace();
        }

        socket.close();
    }
}
```
  - socket.setSoTimeout() : ë°€ë¦¬ì´ˆ ë‹¨ìœ„ë¡œ íƒ€ì„ì•„ì›ƒ ì‹œê°„ ì„¤ì • ê°€ëŠ¥ (ì—¬ê¸°ì„œëŠ” 3ì´ˆë¡œ ì„¤ì •)
  - 3ì´ˆê°€ ì§€ë‚˜ë©´, ë‹¤ìŒ ì˜ˆì™¸ ë°œìƒ (```java.net.SocketTimeoutException: Read timed out```)
  - íƒ€ì„ì•„ì›ƒ ì‹œê°„ì„ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ read()ëŠ” ì‘ë‹µì´ ì˜¬ ë•Œ ê¹Œì§€ ë¬´í•œì • ëŒ€ê¸°
  - í´ë¼ì´ì–¸íŠ¸ ì‹¤í–‰ ê²°ê³¼
```
java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:278)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:304)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:346)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:796)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:1099)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:1093)
	at network.tcp.exception.connect.SoTimeoutClient.main(SoTimeoutClient.java:15)
```

6. ì°¸ê³ 
   - ì‹¤ë¬´ì—ì„œ ìì£¼ ë°œìƒí•˜ëŠ” ì¥ì•  ì›ì¸ ì¤‘ í•˜ë‚˜ê°€ ë°”ë¡œ ì—°ê²° íƒ€ì„ ì•„ì›ƒ, ì†Œì¼“ íƒ€ì„ì•„ì›ƒ(read íƒ€ì„ì•„ì›ƒ)ì„ ëˆ„ë½í•˜ê¸° ë•Œë¬¸ì— ë°œìƒ
   - ì„œë²„ë„ ì™¸ë¶€ì— ì¡´ì¬í•˜ëŠ” ë°ì´í„°ë¥¼ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ë¶ˆëŸ¬ì™€ì•¼ í•˜ëŠ” ê²½ìš° ì¡´ì¬
   - ì˜ˆ) ì£¼ë¬¸ì„ ì²˜ë¦¬í•˜ëŠ” ì„œë²„ê°€ ìˆëŠ”ë°, ì£¼ë¬¸ ì„œë²„ëŠ” ì™¸ë¶€ì— ìˆëŠ” ì„œë²„ë¥¼ í†µí•´ ê³ ê°ì˜ ì‹ ìš©ì¹´ë“œ ê²°ì œë¥¼ ì²˜ë¦¬í•´ì•¼ í•œë‹¤ê³  ê°€ì •
     + ì‹ ìš©ì¹´ë“œë¥¼ ì²˜ë¦¬í•˜ëŠ” íšŒì‚¬ê°€ 3ê°œ ìˆë‹¤ê³  ê°€ì •
       * ê³ ê° â†’ ì£¼ë¬¸ ì„œë²„ â†’ ì‹ ìš©ì¹´ë“œA íšŒì‚¬ ì„œë²„ (ì •ìƒ)
       * ê³ ê° â†’ ì£¼ë¬¸ ì„œë²„ â†’ ì‹ ìš©ì¹´ë“œB íšŒì‚¬ ì„œë²„ (ì •ìƒ)
       * ê³ ê° â†’ ì£¼ë¬¸ ì„œë²„ â†’ ì‹ ìš©ì¹´ë“œC íšŒì‚¬ ì„œë²„ (ë¬¸ì œ)

     + ì‹ ìš©ì¹´ë“œ A, B ì„œë²„ëŠ” ë¬¸ì œê°€ ì—†ê³ , ì‹ ìš©ì¹´ë“œ C íšŒì‚¬ ì„œë²„ì— ë¬¸ì œê°€ ë°œìƒí•´ì„œ ì‘ë‹µì„ ì£¼ì§€ ëª»í•˜ëŠ” ìƒí™©ì´ë¼ê³  ê°€ì •
     + ì£¼ë¬¸ ì„œë²„ëŠ” ê³„ì† ì‹ ìš©ì¹´ë“œ C íšŒì‚¬ ì„œë²„ì˜ ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ê²Œ ë¨
     + ì—¬ê¸°ì„œ ë¬¸ì œëŠ”, ì‹ ìš©ì¹´ë“œ Cì˜ ê²°ì œì— ëŒ€í•´ ì£¼ë¬¸ ì„œë²„ë„ ê³ ê°ì—ê²Œ ì‘ë‹µì„ ì£¼ì§€ ëª»í•˜ê³  ê³„ì† ëŒ€ê¸°
     + ì‹ ìš©ì¹´ë“œ Cë¡œ ì£¼ë¬¸í•˜ëŠ” ê³ ê°ì´ ëˆ„ì ë  ìˆ˜ë¡, ì£¼ë¬¸ ì„œë²„ì˜ ìš”ì²­ì€ ê³„ì† ìŒ“ì´ê²Œ ë˜ê³ , ì‹ ìš©ì¹´ë“œ C íšŒì‚¬ ì„œë²„ì˜ ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” Threadë„ ì ì  ëŠ˜ì–´ë‚¨
     + ê²°êµ­ ì£¼ë¬¸ ì„œë²„ì— ë„ˆë¬´ ë§ì€ ì‚¬ìš©ìê°€ ì ‘ì†í•˜ê²Œ ë˜ë©´ì„œ ì£¼ë¬¸ ì„œë²„ì— ì¥ì• ê°€ ë°œìƒ

     + ê²°ê³¼ì ìœ¼ë¡œ ì‹ ìš©ì¹´ë“œ C ë–„ë¬¸ì—, ì‹ ìš©ì¹´ë“œ A, ì‹ ìš©ì¹´ë“œ Bë¥¼ ì‚¬ìš©í•˜ëŠ” ê³ ê°ê¹Œì§€ ëª¨ë‘ ì£¼ë¬¸ì„ í•  ìˆ˜ ì—†ëŠ” ì‚¬íƒœ ë°œìƒ
     + ë§Œì•½, ì£¼ë¬¸ ì„œë²„ì— ì—°ê²° / ì†Œì¼“ íƒ€ì„ ì•„ì›ƒì„ ì ì ˆíˆ ì„¤ì •í–ˆë‹¤ë©´, ì‹ ìš©ì¹´ë“œ C íšŒì‚¬ ì„œë²„ê°€ ì—°ê²°ì´ ì˜¤ë˜ ê±¸ë¦¬ê±°ë‚˜ ì‘ë‹µì„ ì£¼ì§€ ì•Šì„ ë•Œ íƒ€ì„ ì•„ì›ƒìœ¼ë¡œ ì²˜ë¦¬ ê°€ëŠ¥
     + ì´ë ‡ê²Œ ë˜ë©´, ìš”ì²­ì´ ìŒ“ì´ì§€ ì•Šê¸° ë–„ë¬¸ì—, ì£¼ë¬¸ ì„œë²„ì— ì¥ì• ê°€ ë°œìƒí•˜ì§€ ì•ŠìŒ
     + íƒ€ì„ì•„ì›ƒì´ ë°œìƒí•˜ëŠ” ì‹ ìš©ì¹´ë“œ C ì‚¬ìš©ìì—ê²ŒëŠ” í˜„ì¬ ë¬¸ì œê°€ ìˆë‹¤ëŠ” ì•ˆë‚´ë¥¼ í•˜ë©´ ë¨ (ë‚˜ë¨¸ì§€ ì‹ ìš©ì¹´ë“œ A, ì‹ ìš©ì¹´ë“œ BëŠ” ì •ìƒì  ì‘ë™)

  - ğŸ’¡ ë”°ë¼ì„œ, ì™¸ë¶€ ì„œë²„ì™€ í†µì‹ ì„ í•˜ëŠ” ê²½ìš°, ë°˜ë“œì‹œ ì—°ê²° íƒ€ì„ì•„ì›ƒê³¼ ì†Œì¼“ íƒ€ì„ì•„ì›ƒì„ ì§€ì •
